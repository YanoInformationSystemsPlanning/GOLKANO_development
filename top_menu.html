<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>トップメニュー</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <style>
    :root { --bg:#ffffff; --fg:#222; --muted:#f6f6f6; --border:#d0d0d0; --accent:#007bff; }
    html, body { margin:0; padding:0; background:var(--bg); color:var(--fg); font-family:system-ui, -apple-system, Segoe UI, Roboto, "ヒラギノ角ゴ ProN", "Noto Sans JP", sans-serif; }
    header { position:sticky; top:0; background:var(--muted); border-bottom:1px solid var(--border); padding:12px 16px; }
    header h1 { margin:0; font-size:18px; }
    main { padding:16px; }
    .menu { display:flex; flex-wrap:wrap; gap:12px; }
    .menu-button {
      appearance:none; cursor:pointer;
      padding:10px 14px; border:1px solid var(--border); border-radius:10px;
      background:#fff; font-size:16px; min-width:200px; text-align:center;
      transition: transform .02s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .menu-button:hover { box-shadow:0 2px 10px rgba(0,0,0,.08); border-color:#bbb; }
    .menu-button:active { transform: translateY(1px); }
    .admin-badge { font-size:12px; color:#555; margin-top:8px; }
  </style>
</head>
<body>
  <header>
    <h1>トップメニュー</h1>
  </header>

  <main>
    <div id="menu" class="menu" aria-label="機能メニュー"></div>
    <div id="roleInfo" class="admin-badge" aria-live="polite"></div>
  </main>

  <script>
    // --- ロール判定 ---
    // 既存ページなどで window.role が定義されていればそれを採用。
    // 未定義なら localStorage.role を参照。どちらも無ければ "user"。
    const resolvedRole = (typeof window.role === "string" && window.role) ||
                         (localStorage.getItem("role") || "").trim() ||
                         "user";

    // --- メニュー定義 ---
    // 表示順に配列定義。「adminOnly:true」の項目は admin のみ表示。
    const menuItems = [
      { label: "シフト希望", href: "shift_adjustment_survey.html" },
      { label: "シフト希望確認準備", href: "input_data_uploader.html", adminOnly: true }, // ★ 追加ボタン（admin限定）
      { label: "シフト希望集約", href: "shift_aggregate.html" }
    ];

    // --- 描画 ---
    const menuEl = document.getElementById("menu");
    const roleInfoEl = document.getElementById("roleInfo");

    function createButton(item) {
      const btn = document.createElement("button");
      btn.className = "menu-button";
      btn.type = "button";
      btn.textContent = item.label;
      btn.addEventListener("click", () => { location.href = item.href; });
      return btn;
    }

    function renderMenu(role) {
      menuEl.innerHTML = "";
      menuItems.forEach(item => {
        if (item.adminOnly && role !== "admin") return; // admin限定
        menuEl.appendChild(createButton(item));
      });
      roleInfoEl.textContent = (role === "admin")
        ? "現在の権限: 管理者（admin）"
        : "現在の権限: 一般（user）";
    }

    renderMenu(resolvedRole);
    // 参考: 動的に切り替える場合は localStorage.setItem('role','admin') などを行い、再描画してください。
    // 例) localStorage.setItem('role','admin'); location.reload();
  </script>
</body>
</html>
